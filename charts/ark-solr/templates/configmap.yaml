{{- if (include "arkcase.subsystem.enabled" .) }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "arkcase.fullname" . | quote }}
  namespace: {{ .Release.Namespace | quote }}
  labels: {{- include "arkcase.labels" . | nindent 4 }}
    {{- with (.Values.labels).common }}
      {{- toYaml . | nindent 4 }}
    {{- end }}
  annotations:
    timestamp: {{ date "20060102150405" now | quote }}
    {{- with (.Values.annotations).common }}
      {{- toYaml . | nindent 4 }}
    {{- end }}
data:
  entrypoint: |-
    {{- .Files.Get "files/entrypoint" | nindent 4 }}
  config-pre.sh: |-
    {{- .Files.Get "files/config-pre.sh" | nindent 4 }}
  config-post.sh: |-
    {{- .Files.Get "files/config-post.sh" | nindent 4 }}
  deploy-configs.sh: |-
    {{- .Files.Get "files/pre/deploy-configs.sh" | nindent 4 }}
  create-cores.sh: |-
    {{- .Files.Get "files/post/create-cores.sh" | nindent 4 }}
binaryData:
  arkcase-conf.tar.gz: |-
    {{- .Files.Get "files/pre/arkcase-conf.tar.gz" | b64enc | nindent 4 }}
{{- end }}
