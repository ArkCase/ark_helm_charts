{{- if (include "arkcase.tools.enabled" .) }}
{{- $serviceType := ((.Values.service).type | default "NodePort") -}}
apiVersion: v1
kind: Service
metadata:
  name: {{ include "common.fullname" . | quote }}
  namespace: {{ .Release.Namespace | quote }}
  labels: {{- include "common.labels" . | nindent 6 }}
spec:
  type: {{ $serviceType | quote }}
  {{- if (eq $serviceType "ClusterIP") }}
  clusterIP: {{ .Values.service.clusterIP | default "none" }}
  {{- end }}
  {{- if and (eq $serviceType "LoadBalancer") (.Values.service).loadBalancerIP }}
  loadBalancerIP: {{ .Values.service.loadBalancerIP }}
  {{- end }}
  {{- if and (eq $serviceType "LoadBalancer") (.Values.service).loadBalancerSourceRanges }}
  loadBalancerSourceRanges: {{- toYaml .Values.service.loadBalancerSourceRanges | nindent 4 }}
  {{- end }}
  ports:
    - name: solr
      protocol: TCP
      port: 8983
      {{- if (or (eq (.Values.service).type "NodePort") (eq (.Values.service).type "LoadBalancer")) }}
      {{- if (.Values.service).nodePort }}
      nodePort: {{ .Values.service.nodePort }}
      {{- end }}
      {{- else if (eq (.Values.service).type "ClusterIP") }}
      nodePort: null
      {{- end }}
  selector: {{- include "common.labels.matchLabels" . | nindent 4 }}
{{- end }}
