{{- if (include "arkcase.subsystem.enabled" .) }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "common.fullname" . | quote }}
  namespace: {{ .Release.Namespace | quote }}
  labels: {{- include "common.labels" . | nindent 4 }}
    {{- with .Values.labels }}
    {{- toYaml . | nindent 4 }}
    {{- end }}
  annotations:
    timestamp: {{ date "20060102150405" now | quote }}
    {{- with .Values.annotations }}
      {{- toYaml . | nindent 4 }}
    {{- end }}
data:
  application.yml: |-
    server.port: 9999
    spring:
      profiles.active: native
      cloud.config.server:
        native.searchLocations: file://${ark_extension_path}/acm/acm-config-server-repo, file://${ark_extension_path}/acm/acm-config-server-repo/rules, file://${ark_extension_path}/acm/acm-config-server-repo/lookups, file://${ark_extension_path}/acm/acm-config-server-repo/ldap, file://${ark_extension_path}/acm/acm-config-server-repo/labels
      jms:
        pub-sub-domain: true
    properties.folder.path: ${ark_extension_path}/acm/acm-config-server-repo
    branding.files.folder.path: ${ark_extension_path}/acm/acm-config-server-repo/branding
    logging:
      # file.max-history: 10
      # file.max-size: 10MB
      file: /dev/stdout
      level:
        com.armedia.acm.configserver: debug
        org.springframework.cloud.config: debug
      pattern:
        file: "%d{yyyy-MM-dd HH:mm:ss,SSS} [%thread] %-5level %logger.%M - %msg%n"
    jms.message.buffer.window: 1
    acm.activemq:
      broker-url: ${ACTIVE_MQ_URL}
      user: ${ACTIVE_MQ_USERNAME}
      password: ${ACTIVE_MQ_PASSWORD}
      default-destination: configuration.changed
      labels-destination: labels.changed
      ldap-destination: ldap.changed
      lookups-destination: lookups.changed
      rules-destination: rules.changed
      timeout: 10 #seconds
      # keystore: {{ keystore location | quote }}
      # keystore-password: {{ keystore password | quote }}
      # truststore: {{ truststore location | quote }}
      # truststore-password: {{ truststore password | quote }}
    arkcase.languages: "-de,-en,-en-in,-es,-fr,-hi,-ja,-pt,-ru,-zh-cn,-zh-tw"
{{- end }}
