modules:
  headers: add
  proxy: add
  proxy_html: add
  proxy_http: add
  proxy_wstunnel: add
  rewrite: add
  socache_shmcb: add
  xml2enc: add

confs:
  ark-config: |
    ProxyPreserveHost On
    Redirect "/config" "/config/"
    <Location "/config/">
        ProxyPass           http://config:9999/
        ProxyPassReverse    http://config:9999/
        ProxyHTMLEnable     On
        ProxyHTMLURLMap     http://config:9999/(.*) /config/$1 Rx
        ProxyHTMLURLMap     /(.*)                   /config/$1 Rx
    </Location>

  ark-messaging: |
    ProxyPreserveHost On
    Redirect "/messaging" "/messaging/"
    <Location "/messaging/">
        ProxyPass           http://messaging:8161/
        ProxyPassReverse    http://messaging:8161/
        ProxyHTMLEnable     On
        ProxyHTMLURLMap     http://messaging:8161/admin/(.*) /messaging/admin/$1 Rx
        ProxyHTMLURLMap     /admin/(.*)                      /messaging/admin/$1 Rx
        ProxyHTMLURLMap     http://messaging:8161/api/(.*)   /messaging/api/$1 Rx
        ProxyHTMLURLMap     /api/(.*)                        /messaging/api/$1 Rx
    </Location>

  ark-search: |
    ProxyPreserveHost On
    Redirect "/search" "/search/"
    <Location "/search/">
        ProxyPass           http://search:8983/solr/
        ProxyPassReverse    http://search:8983/solr/
        ProxyHTMLEnable     On
        ProxyHTMLURLMap     http://search:8983/solr/(.*) /search/$1 Rx
        ProxyHTMLURLMap     /solr/(.*)                   /search/$1 Rx
        #ProxyHTMLURLMap     http://search:8983/solr/ /search/
        #ProxyHTMLURLMap     http://search:8983/solr  /search
        #ProxyHTMLURLMap     /solr/                   /search/
        #ProxyHTMLURLMap     /solr                    /search
    </Location>

  ark-viewer: |
    ProxyPreserveHost On
    Redirect "/viewer" "/viewer/"
    <Location "/viewer/">
        ProxyPass           http://viewer:8080/VirtualViewerJavaHTML5/
        ProxyPassReverse    http://viewer:8080/VirtualViewerJavaHTML5/
        ProxyHTMLEnable     On
        ProxyHTMLURLMap     http://viewer:8080/VirtualViewerJavaHTML5/(.*) /viewer/$1 Rx
        ProxyHTMLURLMap     /VirtualViewerJavaHTML5/(.*)                   /viewer/$1 Rx
    </Location>
