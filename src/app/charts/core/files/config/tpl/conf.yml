{{- $portal := (include "arkcase.portal" $ | fromYaml) -}}
{{- $custom := (include "arkcase.customization" $) -}}
{{- $customBase := (printf "%s_base" $custom) -}}
{{- $profiles := (empty $portal) | ternary (list $customBase $custom "server" "runtime") (list $customBase "foia" $custom "server" "FOIA_server" "runtime") -}}
{{- $appNames := list "arkcase" "arkcase-activemq" "arkcase-oidc" "ldap" "lookups" ((empty $portal) | ternary "" "arkcase-portal") -}}
application:
  name:
    #
    # This could be:
    #   - Normal: arkcase,arkcase-activemq,arkcase-oidc,ldap,lookups
    #   - FOIA: arkcase,arkcase-activemq,arkcase-oidc,ldap,lookups,arkcase-portal
    #
    active: {{ $appNames | compact | join "," | quote }}

    #
    # This should be "arkcase"
    #
    default: "arkcase"

  #
  # This could be:
  #   - Normal: custom_base,custom,server,runtime
  #   - FOIA: custom_base,foia,custom,server,FOIA_server,runtime
  profile: {{ $profiles | compact | join "," | quote }}

spring:
  cloud:
    config:
      tls:
        enabled: true
        keyStore: "file:${JAVA_KEYSTORE}"
        keyStoreType: "${JAVA_KEYSTORE_TYPE}"
        keyStorePassword: "${JAVA_KEYSTORE_PASS}"
        keyPassword: "${JAVA_KEYSTORE_KEY_PASS}"
        trustStore: "file:${JAVA_TRUSTSTORE}"
        trustStoreType: "${JAVA_TRUSTSTORE_TYPE}"
        trustStorePassword: "${JAVA_TRUSTSTORE_PASS}"

configuration:
  client:
    branding.path: "branding"
    labels.path: "labels"
    ldap.path: "ldap"
    lookups.path: "lookups"
    stylesheets.path: "pdf-stylesheets"
    rules.path: "rules"
    extraFields.path: "schemas/json"
    spring.path: "spring"
  server:
    # It's not pretty, but it's OK to hardcode this for now b/c we're going to get rid of
    # a separate cloudconfig instance in the (hopefully) near future
    url: "https://localhost:9999"
    update.path: "/config/{applicationName}"
    remove.path: "/config/remove/{applicationName}"
    reset.path: "/reset"
    update.file.path: "/file"
    modules.path: "/config/modules"
