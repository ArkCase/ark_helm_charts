{{- $foia := (include "arkcase.foia" $ | fromYaml) -}}
{{- if $foia -}}
  {{- $baseUrl := (include "arkcase.tools.parseUrl" (include "arkcase.tools.conf" (dict "ctx" $ "value" "baseUrl")) | fromYaml) -}}
  {{- $messaging := (include "arkcase.tools.parseUrl" (include "arkcase.tools.conf" (dict "ctx" $ "value" "messaging.url")) | fromYaml) -}}
  {{- $ldapDomain := (include "arkcase.ldap" (dict "ctx" $ "server" $ldapServer "value" "domain")) -}}
logging.level.web=DEBUG

# server.port=8080
# server.servlet.context-path=/${portal.applicationName}

# Property used for enable/disable Spring security. For authenticated portal comment this property.  
#spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,org.springframework.boot.actuate.autoconfigure.security.servlet.ManagementWebSecurityAutoConfiguration


# External portal properties
portal.applicationName=external-portal-api
portal.host={{ $baseUrl.host }}
portal.port={{ $baseUrl.port }}
portal.uiApplicationUrl={{ $baseUrl.scheme }}://{{ $baseUrl.hostPort }}/foia
portal.uiApplicationHost={{ $baseUrl.scheme }}://{{ $baseUrl.hostPort }}
portal.id={{ $foia.portalId | default "8c41ee4e-49d4-4acb-8bce-866e52de3e4e" }}

# portal configuration type
portal.externalConfiguration=true

portal.authenticatedMode={{ not $foia.disableAuth }}

#portal.authorizedUrlsAuthenticated=
portal.authorizedUrlsAuthenticated=/rest/request/readingroom,/rest/users/login,/rest/users/logout,/rest/users/registrations/**,/rest/request/authenticatedMode
portal.authorizedUrlsNotAuthenticated=/rest/request/**
portal.authenticationUserMethods=getReadingRoom,postInquiry,getSuggestedRequests

portal.homeDir=${user.home}/.${portal.applicationName}
portal.fileDir=files

portal.activemqUrl={{ $messaging.url }}
portal.activemqSendQueue=external-foia-requests
portal.activemqReceiveQueue=foia-request-files
# activemq timeout configuration in seconds
portal.activemq.sendTimeout=10
portal.activemq.connectResponseTimeout=10

# authentication type, possible values (basic, external)
portal.authenticationType=basic
# basic
portal.authenticationBasicUser=arkcase-admin@{{ $ldapDomain }}
portal.authenticationBasicPassword={{ arkcase_admin_password }}
# external
portal.authenticationExternalUser=arkcase-admin@{{ $ldapDomain }}

# ArkCase url
portal.arkcaseUrl=http://localhost:8080/arkcase

spring.servlet.multipart.max-file-size=-1
spring.servlet.multipart.max-request-size=-1
{{- end -}}
