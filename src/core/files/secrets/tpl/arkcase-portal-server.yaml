{{- $foia := (include "arkcase.foia" $ | fromYaml) -}}
{{- if $foia -}}
  {{- $baseUrl := (include "arkcase.tools.parseUrl" (include "arkcase.tools.conf" (dict "ctx" $ "value" "baseUrl")) | fromYaml) -}}
  {{- $messaging := (include "arkcase.tools.parseUrl" (include "arkcase.tools.conf" (dict "ctx" $ "value" "messaging.url")) | fromYaml) -}}
  {{- $ldapDomain := (include "arkcase.ldap" (dict "ctx" $ "server" $foia.ldap.server "value" "domain")) -}}
logging.level.web: DEBUG

# server.port: 8080
# server.servlet.context-path: /${portal.applicationName}

# Property used for enable/disable Spring security. For authenticated portal comment this property.  
#spring.autoconfigure.exclude: org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,org.springframework.boot.actuate.autoconfigure.security.servlet.ManagementWebSecurityAutoConfiguration

portal.externalConfiguration: true
portal.host: {{ $baseUrl.host | quote }}
portal.port: {{ $baseUrl.port }}
portal.uiApplicationUrl: {{ printf "%s://%s/foia" $baseUrl.scheme $baseUrl.hostPort | quote }}
portal.uiApplicationHost: {{ printf "%s://%s" $baseUrl.scheme $baseUrl.hostPort | quote }}
portal.id: {{ $foia.portalId | default "8c41ee4e-49d4-4acb-8bce-866e52de3e4e" }}

portal.authenticatedMode: {{ not $foia.disableAuth }}

portal.authorizedUrlsAuthenticated:
#portal.authorizedUrlsAuthenticated: /rest/request/readingroom,/rest/users/login,/rest/users/logout,/rest/users/registrations/**,/rest/request/authenticatedMode,/rest/request/document,/rest/inquiry, /actuator/bus-refresh
portal.authorizedUrlsNotAuthenticated: /rest/request/**, /rest/inquiry

portal.homeDir: ${user.home}/.${portal.applicationName}

portal.activemqUrl: {{ $messaging.url | quote }}
portal.activemqSendQueue: external-foia-requests
portal.activemqReceiveQueue: foia-request-files
portal.activemq.sendTimeout: 10
portal.activemq.connectResponseTimeout: 10

# authentication type, possible values (basic, external)
portal.authenticationType: basic
# basic
portal.authenticationBasicUser: &foiaAdmin {{ printf "foia-admin@%s" $ldapDomain | quote }}
portal.authenticationBasicPassword: "$foia-admin$"
# external
portal.authenticationExternalUser: *foiaAdmin

# ArkCase url
portal.arkcaseUrl: "http://localhost:8080/arkcase"
{{- end -}}
