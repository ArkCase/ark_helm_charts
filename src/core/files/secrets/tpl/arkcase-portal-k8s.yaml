{{- $foia := (include "arkcase.foia" $ | fromYaml) -}}
{{- if $foia -}}
  {{- $baseUrl := (include "arkcase.tools.parseUrl" (include "arkcase.tools.conf" (dict "ctx" $ "value" "baseUrl")) | fromYaml) -}}
  {{- $uiApplicationHost := (printf "%s://%s" $baseUrl.scheme $baseUrl.hostPort) -}}
logging:
  level:
    com.arkcase.portal: debug
    org:
      springframework: warn
      apache: warn
    springfox: warn

portal:
  uiApplicationUrl: &url {{ printf "%s/foia" $uiApplicationHost | quote }}
  uiApplicationHost: {{ $uiApplicationHost | quote }}
  id: {{ $foia.portalId | quote }}
  url: *url
  arkcaseUrl: "http://localhost:8080/arkcase"
  groupName: "FOIA_USER@{{ $foia.ldap.domain | upper }}"
  # authentication type, possible values (basic, external)
  authenticationType: "basic"
  userId: "foia-admin@{{ $foia.ldap.domain }}"
  password: "$foia-admin$"
  # portal configuration type
  externalConfiguration: true
  authenticatedMode: {{ not $foia.disableAuth }}
  activemqUrl: {{ include "arkcase.core.messaging.openwire" $ | quote }}
  activemqUsername: {{ include "arkcase.tools.conf" (dict "ctx" $ "value" "messaging.username") | quote }}
  activemqPassword: {{ include "arkcase.tools.conf" (dict "ctx" $ "value" "messaging.password") | quote }}
  serviceProvider:
    directory.name: "foiaportal"
  # We use empty stores for now ... THIS SHOULD NOT BE HANDLED HERE
  keystoreFilename: &keystore arkcase.ks
  keystorePassword: &keystorePass "storePassword"
  truststoreFilename: *keystore
  truststorePassword: *keystorePass
  security.authentication:
    header.parameter.name: foia-api-secret
    token:  {{ $foia.apiSecret | quote }}
{{- end -}}
